<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canvas com Quadrado Azul e Fundo</title>
    <style>
        body{
            background-color: rgb(17, 22, 95);
        }
        canvas {
            
            position: relative;
            margin:auto;
            display: flex;
        
        }

    </style>
</head>

<body>
    <canvas id="canvas" width="700" height="600"></canvas>
    <img id="fundo" src="fundo2.jpg" style="display:none;">
    <img id="cblack" src="cblack-removebg-preview.png" height="50px" width="50px" style="display:none;">
    <img id="cred" src="cred.png" height="50px" width="50px" style="display:none;">
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const CANVAS_HEIGHT = canvas.height;
        const CANVAS_WIDTH = canvas.width;
        const fundo = document.getElementById('fundo');
        const cblack = document.getElementById('cblack');
        const cred = document.getElementById('cred');
        var x = 0;
        var x2 = 960;
        var velocityF = 5;
        var isJumping = false;
        var squareX = 50;
        var squareY = 280;
        var square2Y = 320;
        var square4Y = 280; // Definindo a mesma posição Y para ambos os quadrados preto e vermelho
        var square2X = 500;
        var square3X = 2823;
        var square4X = 11225;
        let velocidadeX = 10;
        let velocidade2X = 5;

        function animate() {
            ctx.clearRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);

            if (x < -960) {
                x = 960;
            }
            if (x2 < -960) {
                x2 = 960;
            }
            ctx.drawImage(fundo, x2, 0);
            ctx.drawImage(fundo, x, 0);
            x -= velocityF;
            x2 -= velocityF;
            drawSquare(); // Desenha o quadrado a cada quadro
            rodar(); // Move os quadrados pretos e vermelhos
            detectCollision(); // Detecta colisão entre o quadrado azul e os obstáculos
            requestAnimationFrame(animate);
        }

        function drawSquare() {
             // Limpa o quadrado anterior
            ctx.fillStyle = 'blue';
            ctx.drawImage(cblack,squareX, squareY, 50, 100);
        }

        function rodar() {
            ctx.fillStyle = 'black';
            square2X -= velocidade2X;
            ctx.drawImage(cred,square2X, square2Y, 50, 50);
            //
            ctx.fillStyle = 'red';
            square3X -= velocidade2X;
            ctx.drawImage(cred,square3X, square2Y, 50, 50);
            //
            square4X -= velocidadeX;
            ctx.drawImage(cred, square4X, square4Y, 30, 100);
            if (square2X < -150 ){
                square2X = 700;
            }if (square3X < -150) {
                square3X = 900;
            }
            if (square4X < -150) {
                square4X = 6000;
            }

        }

        function detectCollision() {
            // Verifica se o quadrado azul colide com os obstáculos
            if (squareY + 50 > square4Y && squareY < square4Y + 50) {
                if ((squareX < square2X + 10 && squareX + 10 > square2X) || (squareX < square3X + 10 && squareX + 10 > square3X) || (squareX < square4X + 30 && squareX + 30 > square4X)) {
                    alert('voce perdeu')// Exibe uma mensagem de alerta quando ocorre uma colisão
                    atualizarPagina();// Reinicia o jogo
                    squareY = 280;
                    x = 0;
                    x2 = 960;
                    square2X = 699;
                    square3X = 2800;
                    square4X = 11000;

                }
            }
        }

        document.addEventListener('keydown', function (event) {
            if (event.code === 'Space') {
                jump();
            }
            if (event.keyCode === 39) {
                squareX += 10;
            }
            if (event.keyCode === 37) {
                squareX -= 10 ;
            }
        });

        function jump() {
            if (!isJumping) {
                isJumping = true;
                var jumpInterval = setInterval(function () {
                    squareY -= 15; // Move o quadrado para cima
                    drawSquare();
                    if (squareY <= 50) {
                        clearInterval(jumpInterval);
                        // Inicia o movimento de descida após o pulo
                        var descentInterval = setInterval(function () {
                            squareY += 20; // Move o quadrado para baixo
                            drawSquare();
                            if (squareY >= 280) {
                                clearInterval(descentInterval);
                                isJumping = false; // Reseta a variável de controle de pulo
                            }
                        }, 20);
                    }
                }, 20);
            }
        }
        function atualizarPagina(){
        location.reload();
        }

        animate(); // Inicia a animação
    </script>
</body>

</html>